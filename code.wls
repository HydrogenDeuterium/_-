#!wolframscript -file
(* ::Package:: *)

(* ::Input:: *)
(* 进料泡点 *)
pA:=Exp[15.9008-2788.51/(T-52.36)];
pB:=Exp[16.0676-3295.12/(T-55.6)];
(* 单位：毫米汞柱 *)
xA=0.728;xB=1-xA;atm=760;
root=FindRoot[xA pA+xB pB==atm,{T,273.15}];
T-273.15/.root
(* 88.2284 *)

(* ::Input:: *)
(* 塔顶泡点 *)
bubblePoint[xA_]:=FindRoot[xA pA+(1-xA) pB==atm,{T,273.15}];
(T-273.15)/.bubblePoint[0.993]
(* 80.2855 *)

(* ::Input:: *)
(* 塔底泡点 *)
(T - 273.15) /. bubblePoint[0.00288]
(* 131.414 *)


(* ::Input:: *)
(* 塔顶平均比热容 *)
CpA={{10,132.51},{20,134.07},{30,135.82},{40,138.01},{50,140.19},{60,142.38},{70,144.57},{80,146.95},{90,149.76},{100,152.57},{110,156.13},{120,160.30},{130,163.63},{140,167.38}};
CpB={{10,149.43},{20,150.01},{30,150.77},{40,152.36},{50,153.57},{60,154.79},{70,157.55},{80,160.4},{90,163.24},{100,166.13},{110,169.02},{120,171.99},{130,174.97},{140,177.98}};
fCpA=Interpolation[CpA,InterpolationOrder->1];
fCpB=Interpolation[CpB,InterpolationOrder->1];
xA=0.993;xB=1-xA;
fCpm[T_]:=xA*fCpA[T]+xB*fCpB[T];
fCpm[40.14]

(* ::Input:: *)
(* 塔底平均比热容 *)
xA=0.00288;xB=1-xA;
fCpm[T_]:=xA*fCpA[T]+xB*fCpB[T];
fCpm[65.71]

(* ::Input:: *)
(* 塔顶气化潜热 *)
qianreA={{10,34080.6},{20,33678.6},{30,33251.6},{40,32807.8},{50,32334.7},{60,31844.8},{70,31325.6},{80,30785.5},{90,30220.3},{100,29630.},{110,29014.5},{120,28369.8},{130,27691.5},{140,26988.1}};
qianreB={{10,41085.1},{20,40729.2},{30,40352.4},{40,39954.6},{50,39540.1},{60,39100.5},{70,38644.2},{80,38166.9},{90,37668.6},{100,37145.3},{110,36605.2},{120,36044.2},{130,35458},{140,34850.9}};
fqrA=Interpolation[qianreA,InterpolationOrder->1];
fqrB=Interpolation[qianreB,InterpolationOrder->1];
xA=0.993;xB=1-xA;
fqrm[T_]:=xA*fqrA[T]+xB*fqrB[T];
fqrm[80.29]

(* ::Input:: *)
(* 塔底汽化潜热 *)
xA=0.00288;xB=1-xA;
fqrm[T_]:=xA*fqrA[T]+xB*fqrB[T];
fqrm[131.41];

(* ::Input:: *)
(* 平均分子量 *)
MeanMmass[x_]:=(x*78.11+(1-x)*112.61)
Print@MeanMmass@{(0.987+0.728)/2,(0.993+0.929)/2}
Print@MeanMmass@{(0.7280+0.00288)/2,(0.929+0.0111)/2}

(* ::Input:: *)
(* 液相密度 *)
rhoA[t_]:=912.13-1.186t
rhoB[t_]:=1124.4-1.0657t
rhoMix[t_,x_]:=(x*rhoA[t]+(1-x)*rhoB[t])
Print[rhoMix[84.26,(0.987+0.728)/2],rhoMix[109.82,(0.987+0.728)/2]]

(* ::Input:: *)
(* 表面张力 *)
{A80,B80}={21.08,26.02}
{A88,B88}={20.20,25.34}
{A131,B131}={15.40,.38}
sigmaMix[A_,B_,x_]:=A*B/(A*(1-x)+B*x)
(sigmaMix[A80,B80,0.987]+sigmaMix[A88,B88,0.728])/2
(sigmaMix[A88,B88,0.0.728]+sigmaMix[A131,B131,0.00288])/2

(* ::Input:: *)
(* 粘度 *)
{A80,B80}={0.306,0.426}
{A88,B88}={0.279,0.394}
{A131,B131}={0.197,0.291}
muMix[A_,B_,x_]:=A*x+B*(1-x)
(muMix[A80,B80,0.987]+muMix[A88,B88,0.728])/2
(muMix[A88,B88,0.728]+muMix[A131,A131,0.00288])/2